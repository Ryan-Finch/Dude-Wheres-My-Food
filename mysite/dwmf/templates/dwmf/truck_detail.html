{% extends 'base.html' %}
{% block content %}

<!-- Main Truck Info -->
<div class="row">
    <div class="col s6">
        <div class="container">
            <h1>{{truck.name}}</h1>
                <div>{{truck.style}}</div>
                <div>{{truck.user}}</div>
                <a href="{%url 'truck_update' truck.pk%}">Edit Truck Profile</a>
                <br>
                <a href="{% url 'truck_delete' truck.pk %}">Delete Truck</a>
        </div>
    </div>

    <!-- Photo container and info -->
    <div class="container">
        <div class="col s6">
            <div class="">
            {% for photo in truck.truckphoto_set.all %}
            <img class="profile" src="{{photo.url}}">
            {% empty %}
            <div>No Photos Uploaded</div>
            {% endfor %}
            {% if truck.truckphoto_set.all|length == 0%}
            <form action="{% url 'truck_photo' truck.id %}" enctype="multipart/form-data" method="POST">
                {% csrf_token %}
                <input type="file" name="photo-file">
                <br><br>
                <input type="submit" class="btn" value="Upload Photo">
            </form>
            {% else%}
            <form action="{% url 'delete_truck_photo' truck.id %}" method="POST">
                {% csrf_token %}
            <input type="submit" value="Delete Photo">
            {% endif %}
            </div>
        </div>
    </div>
</div>
<!-- Menu container and information -->
<div class="row ">
    <div class="col s6">
        <div class="container">
            <h1 class="center">Menu Items</h1>
            <a href="{%url 'menu_create' truck.id%}">Create Menu Item</a>
            <div class="row">
            {%for item in truck.menu_set.all%}
                <div class="col s12 m12 l6">
                    <div class="card small">
                        <div class="card-content">
                            <span class="card-title">{{item.food_name}}</span>
                            <p>{{item.description}}</p>
                            <p>${{item.price}}</p>
                        </div>
                        <div class="card-action">
                            <a href="{%url 'menu_update'  truck.id item.id%}">Update Item</a>
                            <form action="{% url 'delete_item' truck.id item.id %}" method="post">
                                {% csrf_token %}
                                <button type="submit" class="btn right">Remove</button>
                            </form>
                        </div>
                    </div>
                </div>
            {%endfor%}
            </div>
        </div>
    </div>

    <!-- Calendar container and informations -->
    <div class="col s6">
  
        <div class="container row center">
            <h1>Your Calendar</h1>
            {%if truck.calendar_set.count%}
            {%for calendar in truck.calendar_set.all%}
            {%if calendar.date_checker%}
           
            {%else%}
            <ul class="collection col s4">
                <li class="collection-header center"><span>{{calendar.date}}</span></li>
                <li class="collection-item center">Start Time: {{calendar.start_time}}  |  End Time: {{calendar.end_time}}</li>
                <li class="collection-item center">{{calendar.location}}</li>
                <form action="{% url 'delete_calendar' truck.id calendar.id %}" method="post">
                    {% csrf_token %}
                  <button type="submit" class="btn center">Remove</button>
                </form>
            </ul>
            {%endif%}
            {%endfor%}
            {%else%}
                <h4>You have no upcoming dates</h4>
            {%endif%}
           
        </div>
        <br>
        <div class="container row">
            <hr>
            <h3 class="center">New Calendar Date</h3>
            <form action="{%url 'add_calendar' truck.id%}" method="post">
                {%csrf_token%}
                {{calendar_form.as_p}}
                <input type="submit" class="btn" value="Add Date">
            </form>
        </div>
    </div>
</div>




<!-- Scrpit for date and timepicker -->
<script>
    // create a datepicker
    var dateEl = document.getElementById('id_date');
    console.log(dateEl)
    M.Datepicker.init(dateEl, {
      format: 'yyyy-mm-dd',
      defaultDate: new Date(),
      setDefaultDate: true,
      autoClose: true
    });
    
    var start = document.getElementById('id_start_time');
    M.Timepicker.init(start, {
        defaultTime: 'now',
        autoClose: true
    });
    var end = document.getElementById('id_end_time');
    M.Timepicker.init(end, {
        defaultTime: 'now',
        autoClose: true
    });
  </script>
{% endblock %}